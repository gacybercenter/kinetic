<source>
  @type tail
  path /var/log/haproxy
  pos_file /var/log/td-agent/haproxy.pos
  tag openstack.haproxy
  ignore_repeated_permission_error true
  enable_watch_timer false
  <parse>
    @type multiline
    format_firstline /^(?<timestamp>\S+ \S+ \S+) (?<hostname>\S+)/
    format1 /^(?<timestamp>\S+ \S+ \S+) (?<hostname>\S+) (?<ps>\w+)\[(?<pid>\d+)\]: ((?<pri>\w+) |(?<c_ip>[\w\.]+):(?<c_port>\d+)) \[(?<time>.+)\] (?<f_end>[\w-]+) (?<b_end>[\w-]+)\/(?<b_server>[\w-]+) (?<tw>\d+)\/(?<tc>\d+)\/(?<tt>\d+) (?<bytes>\d+) (?<t_state>[\w-]+) (?<actconn>\d+)\/(?<feconn>\d+)\/(?<beconn>\d+)\/(?<srv_conn>\d+)\/(?<retries>\d+) (?<srv_queue>\d+)\/(?<backend_queue>\d+)$/
    time_key Timestamp
    keep_time_key true
    time_format %b %d %H:%M:%S
  </parse>
</source>